---
title: "Objetivo General"
author: "Samuel Espiño, Lucía Gil, Alvar Tomás Ortiz"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Objetivos específicos: 

 Relación de disminución de enfermedades por cultivos trangénicos

## Enlaces de bases de datos relacionados con el tema

Conjunto de datos globales georreferenciado de 173 cultivos alrededor de 2020: [Here](https://figshare.com/articles/dataset/CROPGRIDS/22491997?file=41952177)

Insuficiencia cardiaca: [Here](https://ec.europa.eu/eurostat/databrowser/view/hlth_ehis_pa2u/default/table?lang=en)

Cancer de colon: [Here](https://ec.europa.eu/eurostat/databrowser/view/hlth_ehis_pa5u/default/table?lang=en)

Indice de abortos en Europa: [Here](https://ec.europa.eu/eurostat/databrowser/view/demo_fabortind/default/table?lang=en) 

Cancer de mama : [Here](https://ec.europa.eu/eurostat/databrowser/view/hlth_ps_scre__custom_8587007/default/table?lang=en)

Cardiopatias isquémicas: [Here] (https://gateway.euro.who.int/en/indicators/hfamdb_427-deaths-ischaemic-heart-disease/?id=30289)

## Librerias que importamos para el trabajo
```{r}
library(tidyverse)
library(readxl)
library(rjson)
library(tidyjson)
library(readxl)
```

## Tablas de valores

```{r}
aborto <- read_delim("INPUT/DATA/datos_aborto.tsv", 
    delim = "\t", escape_double = FALSE, 
    trim_ws = TRUE)
aborto <- aborto %>%
    separate(col = 1, into = c("A","ABORT","RT","Pais"), sep = ",") %>%
    mutate(across("2013":"2021", ~na_if(.,":"))) %>%
    mutate(across("2013":"2021", ~as.numeric(.)))
aborto <- select(aborto,Pais,"2013":"2021")
aborto <- aborto %>%
  pivot_longer(
    cols = "2013":"2021",
    names_to = "Año",
    values_to = "Valores"
  )
aborto
```


```{r}
d_mama <- read_delim("INPUT/DATA/datos_cancer_mama.tsv", 
    delim = "\t", escape_double = FALSE, 
    trim_ws = TRUE)
d_mama <- d_mama %>% 
  separate(col = 1, into = c("A","PC","PGR","C50","Pais"), sep = ",") %>%
  mutate(across("2000":"2021", ~na_if(.,":")))
d_mama  <- select(d_mama,Pais,"2000":"2021")
d_mama <- d_mama %>%
  pivot_longer(cols="2000":"2021",
               names_to = "Años",
               values_to = "Valores") %>%
  mutate(Valores = as.numeric(gsub("[^0-9.]", "", Valores)))
d_mama
```


```{r}
d_isquemia <- read_excel("INPUT/DATA/HFAMDB_427_EN.xlsx", 
    sheet = "Data (pivoted)")
d_isquemia <- d_isquemia %>%
  pivot_longer(cols = -c("Measure code", "AGE_GRP", "SEX", "COUNTRY_REGION"),
               names_to = "Año",
               values_to = "Valor")
d_isquemia
```

```{r}
d_cultivos <- read_excel("INPUT/DATA/Table_CROPGRIDS_COU.xlsx")
d_cultivos <- d_cultivos %>% rename(Pais = "Country ISO2 code" )
d_cultivos
```
```{r}
inf_data <- read_excel("INPUT/DATA/HFAMDB_427_EN.xlsx", 
                       sheet = "Data (pivoted)")
inf_data <- inf_data %>%
  pivot_longer(cols = -c("Measure code", "AGE_GRP", "SEX", "COUNTRY_REGION"),
               names_to = "Año",
               values_to = "Valor")
inf_data
```
## Seleccionamos los datos 

Selección de los 3 cultivos que vamos a usar
```{r}
d_cultivos_e <- select(d_cultivos,Pais,cauliflower,cucumberetc,greenbean)
d_cultivos_e <- d_cultivos_e %>% rename(Coliflor="cauliflower")
d_cultivos_e <- d_cultivos_e %>% rename(Pepino="cucumberetc")
d_cultivos_e <- d_cultivos_e %>% rename(Judía_verde="greenbean")
d_cultivos_e
```
Selección de la media de los años 2015-2020 en casos de cardiopatias isquémicas
```{r}
media_cardiopatias <- d_isquemia %>%
  filter(Año >= 2015 & Año <= 2020)
d_isquemia_media <- media_cardiopatias %>%
  group_by(COUNTRY_REGION) %>%
  summarise(Valor_Media = mean(Valor, na.rm = TRUE))
d_isquemia_media
```

Seleccion de la media de los años 2015-2020 en casos de cancer de mama
```{r}
media_casos_mama <- d_mama %>%
  filter(Años >=2015 & Años <=2020)
casos_mama_media <- media_casos_mama %>%
  group_by(Pais) %>%
  summarise(Valor_Media = mean(Valores, na.rm = TRUE))
casos_mama_media
```

Seleccion de la media de los años 2015-2020 en casos de abortos
```{r}
media_casos_aborto<- aborto %>%
  filter(Año >= 2015 & Año <= 2020)
aborto_media <- media_casos_aborto %>%
  group_by(Pais) %>%
  summarise(Valor_Media = mean(Valores, na.rm = TRUE))
aborto_media
```

